"use strict";$("#responsible_phone").mask("+7(999)999-99-99");var btnSave=document.getElementById("btn_save"),warning=document.querySelector(".warning__inner"),checkboxPublicName=document.getElementById("check_public"),publicDescription=document.getElementById("public_description"),groupName=document.querySelector("#group_name"),groupAlias=document.querySelector("#group_alias"),groupMail=document.querySelector("#group_mail"),responsiblePhone=document.querySelector("#responsible_phone"),responsibleName=document.querySelector("#responsible_name"),responsiblePosition=document.querySelector("#responsible_position"),descriptionInner=document.querySelector("#description_inner"),descriptionPublic=document.querySelector("#description_public"),inputs=document.querySelectorAll(".form__input"),checkReg=function(e,t,n){var i=document.createElement("span");i.classList.toggle("validate"),i.classList.toggle("validate__error");var a=e.parentElement.lastElementChild;if("span"===a.tagName.toLowerCase()&&a.remove(),e.classList.contains("form__input--validate--error")&&e.classList.toggle("form__input--validate--error"),e.nextElementSibling.classList.contains("form__label--validate--error")&&e.nextElementSibling.classList.toggle("form__label--validate--error"),!1===t.test(e.value))return e.classList.toggle("form__input--validate--error"),e.nextElementSibling.classList.toggle("form__label--validate--error"),e.parentElement.append(i),i.textContent=n,!1},checkEmpty=function(e){var t=document.createElement("span");t.classList.toggle("validate"),t.classList.toggle("validate__error");var n=e.parentElement.lastElementChild;if("span"===n.tagName.toLowerCase()&&n.remove(),e.classList.contains("form__input--validate--error")&&e.classList.toggle("form__input--validate--error"),e.nextElementSibling.classList.contains("form__label--validate--error")&&e.nextElementSibling.classList.toggle("form__label--validate--error"),""===e.value)return e.classList.toggle("form__input--validate--error"),e.nextElementSibling.classList.toggle("form__label--validate--error"),e.parentElement.append(t),!(t.textContent="Поле пустое, введите символы")},checkInputValues=function(){inputs.forEach(function(e){e.addEventListener("input",function(){"checkbox"!==e.type&&(""!==e.value?btnSave.removeAttribute("disabled"):btnSave.setAttribute("disabled","disabled"))})})},checkInputValuesOnLoad=function(){inputs.forEach(function(e){"checkbox"!==e.type&&""!==e.value&&btnSave.removeAttribute("disabled")})},validMail=function(){checkReg(groupMail,/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,"E-Mail не введен или введен некорректно")},validAlias=function(){checkReg(groupAlias,/^[A-Za-z0-9-]+$/,"Алиас не может быть пустым, содержать русские буквы, пробелы или символы")},saveData=function(){inputs.forEach(function(e){""!=e.value&&"checkbox"!=e.type&&localStorage.setItem(e.name,e.value)})},getData=function(){var n=0;return inputs.forEach(function(e){for(var t in localStorage)t===e.name&&""!=localStorage.getItem([t])&&(e.value=localStorage.getItem([t]),n++)}),0<n},showWarning=function(){warning.classList.toggle("warning__inner--active"),btnSave.setAttribute("disabled","true"),setTimeout(function(){warning.classList.toggle("warning__inner--active"),setTimeout(function(){return btnSave.removeAttribute("disabled")},500)},7e3)},showPublic=function(){return publicDescription.classList.toggle("form-description__item--active")},validName=function(){checkEmpty(groupName)},validResponsibleName=function(){checkEmpty(responsibleName)},validResponsiblePosition=function(){checkEmpty(responsiblePosition)},validDescriptionInner=function(){checkEmpty(descriptionInner)},validDescriptionPublic=function(){checkEmpty(descriptionPublic)};document.addEventListener("DOMContentLoaded",function(){getData()&&(getData(),showWarning()),checkInputValuesOnLoad(),checkInputValues()}),window.addEventListener("beforeunload",saveData),btnSave.addEventListener("click",function(e){e.preventDefault(),saveData(),showWarning()}),checkboxPublicName.addEventListener("input",showPublic),groupAlias.addEventListener("input",validAlias),groupMail.addEventListener("input",validMail),groupName.addEventListener("input",validName),responsibleName.addEventListener("input",validResponsibleName),responsiblePosition.addEventListener("input",validResponsiblePosition),descriptionInner.addEventListener("input",validDescriptionInner),descriptionPublic.addEventListener("input",validDescriptionPublic);